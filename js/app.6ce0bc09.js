(function(t){function e(e){for(var n,s,c=e[0],o=e[1],l=e[2],d=0,h=[];d<c.length;d++)s=c[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&h.push(r[s][0]),r[s]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n]);u&&u(e);while(h.length)h.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],n=!0,c=1;c<a.length;c++){var o=a[c];0!==r[o]&&(n=!1)}n&&(i.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},r={app:0},i=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/spotify-playlist-viz/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=o;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("cd49")},1:function(t,e){},4336:function(t,e,a){"use strict";a("5c0e")},"5c0b":function(t,e,a){"use strict";a("9c0c")},"5c0e":function(t,e,a){},7112:function(t,e,a){t.exports=a.p+"img/Spotify_Logo_RGB_Green.11dc437a.png"},"9c0c":function(t,e,a){},cd49:function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",{attrs:{id:"inspire"}},[n("Auth"),n("v-app-bar",{attrs:{app:"",color:"black",flat:""}},[n("v-toolbar-title",{staticClass:"title"},[t._v("Spotify Playlist Viz")])],1),n("v-main",{staticClass:"grey lighten-3"},[n("v-container",[n("v-container",[n("v-row",[n("v-row",{attrs:{justify:"space-around",align:"center"}},[n("v-col",{attrs:{cols:"12",md:"6"}},[n("v-form",[n("v-text-field",{attrs:{label:"Insert playlist link ...",required:""},model:{value:t.link,callback:function(e){t.link=e},expression:"link"}})],1)],1),n("v-col",{attrs:{cols:"12",md:"6"}},[n("v-btn",{attrs:{elevation:"2",color:"secondary"},on:{click:t.compute}},[t._v(" Search playlist ")])],1)],1)],1)],1),n("v-row",[n("v-col",{attrs:{cols:"12",sm:"9"}},[n("v-sheet",{attrs:{rounded:"lg"}},[n("Canva",{ref:"canva",on:{selectedSong:t.changeSong}})],1),t.selectable?n("v-card",[n("v-card-title",[t._v(t._s(t.extractor.title)+" ")]),n("v-card-subtitle",[t._v(t._s(t.extractor.author)+" ")]),n("v-card-text",[t._v(" "+t._s(t.extractor.description)+" ")])],1):t._e()],1),n("v-col",{attrs:{cols:"12",sm:"3"}},[n("v-sheet",{attrs:{rounded:"lg","min-height":"268",v:""}},[n("v-card",[n("v-img",{attrs:{src:t.current_cover,height:"300","max-height":"300","max-width":"300"},scopedSlots:t._u([{key:"placeholder",fn:function(){return[n("v-row",{staticClass:"fill-height ma-0",attrs:{align:"center",justify:"center"}},[n("v-progress-circular",{attrs:{indeterminate:"",color:"grey lighten-5"}})],1)]},proxy:!0}])}),n("v-card-title",[t._v(" "+t._s(t.current_song))]),n("v-card-subtitle",[t._v(" "+t._s(t.current_artist))])],1)],1)],1)],1)],1)],1),n("v-footer",{attrs:{dark:"",padless:""}},[n("v-card",{staticClass:"flex",attrs:{flat:"",tile:""}},[n("v-card-title",[n("v-btn",{staticClass:"mx-4",attrs:{dark:"",icon:"",href:"https://github.com/ammlyy/spotify-playlist-viz",target:"_blank"}},[n("v-icon",{attrs:{size:"24px"}},[t._v(" mdi-github ")])],1),n("v-spacer"),n("v-img",{attrs:{"max-height":"70","max-width":"150",src:a("7112"),href:"https://www.spotify.com/it/"}})],1)],1)],1)],1)},i=[],s=a("d4ec"),c=a("bee2"),o=a("262e"),l=a("2caf"),u=(a("9911"),a("d81d"),a("9ab4")),d=a("1b40"),h=(a("a4d3"),a("e01a"),a("ac1f"),a("1276"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("b0c0"),a("159b"),a("d9ca")),v=a.n(h),f=a("e83a"),p=a.n(f),m=function(){function t(){Object(s["a"])(this,t),this.access=new v.a,this.title="",this.description="",this.author="",this.songs_list=[],this.model=new p.a({dim:3,perplexity:30,earlyExaggeration:5,learningRate:50,nIter:2e3,metric:"euclidean"})}return Object(c["a"])(t,[{key:"fetchPlaylist",value:function(t){var e=this,a=String(window.location).split("#")[1],n=new URLSearchParams(a),r=n.get("access_token");console.log(r),this.access.setAccessToken(r||"");var i=t.split("/")[4].split("?")[0];return this.songs_list=[],new Promise((function(t){e.access.getPlaylist(i).then((function(a){e.title=a.body.name,e.author=a.body.owner.display_name?a.body.owner.display_name:"",e.description=a.body.description?a.body.description:"",a.body.tracks.items.forEach((function(t){e.songs_list.push({title:t.track.name,artist:t.track.artists[0].name,img:t.track.album.images[1].url,id:t.track.id})})),t(e.songs_list)}))}))}},{key:"extractFeatures",value:function(t){var e=this,a=[];return new Promise((function(n){e.access.getAudioFeaturesForTracks(t).then((function(t){t.body.audio_features.forEach((function(t){a.push([t.acousticness,t.danceability,t.instrumentalness,t.energy,t.key,t.liveness,t.loudness,t.mode,t.speechiness,t.tempo,t.time_signature,t.valence])})),n(a)}))}))}},{key:"trainModel",value:function(t){this.model.init({data:t}),this.model.run();var e=this.model.getOutputScaled();return e}}]),t}(),g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("canvas",{attrs:{id:"c"}})},b=[],y=a("5a89"),_=a("4721"),w=a("b9d8"),x=function(t){Object(o["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.inst_id=0,t.mouse=new y["n"](1,1),t.raycaster=new y["j"],t.instance_id=0,t}return Object(c["a"])(a,[{key:"mounted",value:function(){var t=this,e=document.getElementById("c");if(e){this.camera=new y["h"](70,e.clientWidth/e.clientHeight,.01,10),this.camera.position.z=2,this.camera.lookAt(0,0,0),this.scene=new y["k"],this.material=new y["g"],this.geometry=new y["c"](.5,3),this.geometry.scale(.2,.2,.2),this.renderer=new y["p"]({antialias:!0,canvas:e,alpha:!0}),this.renderer.setClearColor(0,0),this.renderer.setSize(e.clientWidth,e.clientHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.domElement.addEventListener("mousemove",this.onMouseMove.bind(this),!1),this.controls=new _["a"](this.camera,e),this.controls.minDistance=.7,this.controls.maxDistance=5;var a={name:"nome"},n=new w["a"],r=n.addFolder("XYZ");r.add(a,"name"),this.animate(),this.$root.$children[0].$on("dataChanged",(function(e){return t.instantiate(e.length,e)}))}}},{key:"instantiate",value:function(t,e){this.clear();var a=new y["f"];this.mesh=new y["d"](this.geometry,this.material,t);for(var n=0;n<t;n++){a=this.translateMatrix(a,e[n]),this.mesh.setMatrixAt(n,a);var r=this.getColor(e[n]);this.mesh.setColorAt(n,r)}this.scene.add(this.mesh),this.scene.needsUpdate=!0}},{key:"translateMatrix",value:function(t,e){var a=new y["o"];return a.x=2*e[0],a.y=2*e[1],a.z=e[2],t.setPosition(a),t}},{key:"getColor",value:function(t){return new y["a"]((t[0]+1)/2,(t[1]+1)/2,(t[2]+1)/2)}},{key:"onMouseMove",value:function(t){t.preventDefault();var e=this.renderer.domElement.getBoundingClientRect();this.mouse.x=(t.clientX-e.left)/e.width*2-1,this.mouse.y=-(t.clientY-e.top)/e.height*2+1}},{key:"clear",value:function(){while(this.scene.children.length>0)this.scene.remove(this.scene.children[0])}},{key:"animate",value:function(){if(window.requestAnimationFrame(this.animate),this.controls.update(),this.raycaster.setFromCamera(this.mouse,this.camera),this.mesh){var t=this.raycaster.intersectObject(this.mesh);if(t.length>0){var e=t[0].instanceId?t[0].instanceId:0;this.instance_id!=e&&(this.instance_id=e,this.$emit("selectedSong",this.instance_id))}}this.renderer.render(this.scene,this.camera)}}]),a}(d["b"]);x=Object(u["a"])([d["a"]],x);var k=x,j=k,O=(a("4336"),a("2877")),C=Object(O["a"])(j,g,b,!1,null,"62ff1cc0",null),V=C.exports,S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.containsToken()?a("div",{staticClass:"text-center"},[a("v-dialog",{attrs:{persistent:"",width:"500"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"text-h5 grey lighten-2"},[t._v(" Access ")]),a("v-card-text",[t._v(" Authorize the app through your Spotify account. ")]),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"green",text:""},on:{click:t.authRequest}},[t._v(" Here ")])],1)],1)],1)],1):t._e()},P=[],M=(a("5319"),function(t){Object(o["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.dialog=!0,t}return Object(c["a"])(a,[{key:"authRequest",value:function(){var t="https://accounts.spotify.com/authorize";t+="?client_id="+encodeURIComponent("175cd279c85d469b8d435cd78556527a"),t+="&redirect_uri="+encodeURIComponent("https://ammlyy.github.io/spotify-playlist-viz/"),t+="&response_type=token",t+="&state=123",window.location.replace(t),this.dialog=!1}},{key:"containsToken",value:function(){return!window.location.hash}}]),a}(d["b"]));M=Object(u["a"])([d["a"]],M);var T=M,A=T,R=a("6544"),z=a.n(R),E=a("8336"),F=a("b0af"),I=a("99d9"),$=a("169a"),B=a("ce7e"),D=a("2fa4"),q=Object(O["a"])(A,S,P,!1,null,null,null),U=q.exports;z()(q,{VBtn:E["a"],VCard:F["a"],VCardActions:I["a"],VCardText:I["c"],VCardTitle:I["d"],VDialog:$["a"],VDivider:B["a"],VSpacer:D["a"]});var H=function(t){Object(o["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.link="",t.extractor=new m,t.selectable=!1,t.current_song="",t.current_artist="",t.current_cover="",t}return Object(c["a"])(a,[{key:"updated",value:function(){}},{key:"compute",value:function(){var t=this;this.extractor.fetchPlaylist(this.link).then((function(e){return t.extractor.extractFeatures(e.map((function(t){return t.id})))})).then((function(e){return t.extractor.trainModel(e)})).then((function(e){t.$emit("dataChanged",e),t.selectable=!0}))}},{key:"changeSong",value:function(t){this.current_song=this.extractor.songs_list[t].title,this.current_artist=this.extractor.songs_list[t].artist,this.current_cover=this.extractor.songs_list[t].img}}]),a}(d["b"]);H=Object(u["a"])([Object(d["a"])({components:{Canva:V,Auth:U}})],H);var L=H,G=L,J=(a("5c0b"),a("7496")),W=a("40dc"),X=a("62ad"),Y=a("a523"),Z=a("553a"),K=a("4bd4"),N=a("132d"),Q=a("adda"),tt=a("f6c4"),et=a("490a"),at=a("0fd9"),nt=a("8dd9"),rt=a("8654"),it=a("2a7f"),st=Object(O["a"])(G,r,i,!1,null,null,null),ct=st.exports;z()(st,{VApp:J["a"],VAppBar:W["a"],VBtn:E["a"],VCard:F["a"],VCardSubtitle:I["b"],VCardText:I["c"],VCardTitle:I["d"],VCol:X["a"],VContainer:Y["a"],VFooter:Z["a"],VForm:K["a"],VIcon:N["a"],VImg:Q["a"],VMain:tt["a"],VProgressCircular:et["a"],VRow:at["a"],VSheet:nt["a"],VSpacer:D["a"],VTextField:rt["a"],VToolbarTitle:it["a"]});var ot=a("ed18"),lt=a.n(ot),ut=a("ce5b"),dt=a.n(ut),ht=a("f309");n["default"].config.productionTip=!1,lt.a.config(),n["default"].use(dt.a),new n["default"]({vuetify:new ht["a"],render:function(t){return t(ct)}}).$mount("#app")}});
//# sourceMappingURL=app.6ce0bc09.js.map